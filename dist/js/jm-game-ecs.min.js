!function e(t,n,r){function o(a,s){if(!n[a]){if(!t[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(i)return i(a,!0);throw new Error("Cannot find module '"+a+"'")}var l=n[a]={exports:{}};t[a][0].call(l.exports,function(e){var n=t[a][1][e];return o(n||e)},l,l.exports,e,t,n,r)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<r.length;a++)o(r[a]);return o}({1:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=s(e("jm-ecs")),i=s(e("jm-logger")),a=e("jm-utils");function s(e){return e&&e.__esModule?e:{default:e}}var u=i.default.getLogger("area"),l={closed:0,open:1,paused:2},f=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return n.id&&(e.id=n.id),e.State=l,e.maxPlayers=n.maxPlayers||5,e.runTime=0,e.ticks=0,e.players=[],e.state=l.closed,Object.defineProperty(e,"entities",{get:function(){var e=this.em.entities,t=[];for(var n in e){var r=e[n];r!==this&&t.push(r.toJSON())}return t}.bind(e)}),Object.defineProperty(e,"totalPlayers",{get:function(){return this.players.length}.bind(e)}),Object.defineProperty(e,"full",{get:function(){return this.maxPlayers&&this.totalPlayers>=this.maxPlayers}.bind(e)}),Object.defineProperty(e,"empty",{get:function(){return 0===this.totalPlayers}.bind(e)}),e.em.on("update",function(e,t){this.state===l.open&&(this.runTime+=t,this.ticks++)}.bind(e)),e.createPlayer=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.em.createEntity("player",e);return this.emit("addPlayer",t,e),this.players.push(t),t.on("remove",function(){this.emit("removePlayer",t);var e=this.players.indexOf(t);-1!==e&&this.players.splice(e,1),u.debug("remove player: %s",a.utils.formatJSON(t.toJSON()))}.bind(this)),Promise.resolve().then(function(){return t.init?t.init(e):t}).then(function(){return u.debug("add player: %s",a.utils.formatJSON(t.toJSON())),t})},e.findPlayer=function(e){for(var t in this.players){var n=this.players[t];if(n.id===e)return n}return null},e.open=function(){return this.state!==l.closed?(u.warn("area not in closed, can not be open"),!1):(this.runTime=0,this.ticks=0,this.state=l.open,this.emit("open"),u.info("area %s open",this.id),!0)},e.close=function(){return this.state!==l.open&&this.state!==l.paused?(u.warn("area not in open or paused, can not be closed"),!1):(this.state=l.closed,this.clear(),this.emit("close"),u.info("area %s closed",this.id),!0)},e.pause=function(){return this.state!==l.open?(u.warn("area not in open, can not be paused"),!1):(this.state=l.paused,this.emit("pause"),u.info("area %s paused",this.id),!0)},e.resume=function(){return this.state!==l.paused?(u.warn("area not in paused, can not be resume"),!1):(this.state=l.open,this.emit("resume"),u.info("area %s resumed",this.id),!0)},e.clear=function(){var e=this.entities;for(var t in e){e[t].removeFromParent()}},e.toJSON=function(){var e={type:this.type,entityId:this.entityId,id:this.id,state:this.state,runTime:this.runTime,totalPlayers:this.totalPlayers,maxPlayers:this.maxPlayers,players:this.players};return this.emit("toJSON",e),e},r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default.C),r(t,[{key:"className",get:function(){return t.className||t.name}}]),t}();f.className="area",f.singleton=!0,n.default=f,t.exports=n.default},{"jm-ecs":10,"jm-logger":20,"jm-utils":21}],2:[function(e,t,n){(function(r){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=f(e("./area")),a=f(e("./player")),s=f(e("jm-ecs")),u=f(e("jm-logger")),l=e("jm-utils");function f(e){return e&&e.__esModule?e:{default:e}}var c=u.default.getLogger("jm-game-ecs"),y={closed:0,open:1,paused:2},d=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.State=y,n.state=y.closed,n.areas=[],n.uses([{class:i.default},{class:a.default}]),n.entityTypes={area:{components:{area:{}}},player:{components:{player:{}}}},n.on("em",function(e){e.addEntityTypes(this.entityTypes)}.bind(n)),e.disableAutoOpen||n.open(e),Object.defineProperty(n,"players",{get:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var e=this.areas,t=[];for(var n in e){var r=e[n].players;for(var o in r)t.push(r[o])}return t}.bind(n)}),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.default),o(t,[{key:"update",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments[1];if(this.state!==y.open)return!0;t||(t=parseInt(1e3*e));var n=this.areas;for(var r in n){n[r].em.emit("update",e,t)}return!0}},{key:"open",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.state!==y.closed)return c.warn("game not in closed, can not be open"),!1;this.state=y.open,this.emit("open"),c.info("game open");var t=e.interval;return t&&(this._updateTime=Date.now(),this._timer=setInterval(function(){var e=Date.now(),t=e-this._updateTime,n=t/1e3;this._updateTime=e,this.update(n,t)}.bind(this),t)),!0}},{key:"close",value:function(){return this.state!==y.open&&this.state!==y.paused?(c.warn("game not in open or paused, can not be close"),!1):(this.state=y.closed,this._timer&&(clearInterval(this._timer),this._timer=null),this.emit("close"),c.info("game closed"),!0)}},{key:"pause",value:function(){return this.state!==y.open?(c.warn("game not in open, can not be paused"),!1):(this.state=y.paused,this.emit("pause"),c.info("game paused"),!0)}},{key:"resume",value:function(){return this.state!==y.paused?(c.warn("game not in paused, can not be resume"),!1):(this.state=y.open,this.emit("resume"),c.info("game resumed"),!0)}},{key:"createArea",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.areas,n=this.em(),r=n.createEntity("area",e);return t.push(r),n.area=r,this.emit("addArea",r,e),r.on("remove",function(){this.emit("removeArea",r);var e=this.areas.indexOf(r);-1!==e&&this.areas.splice(e,1),c.info("remove area: %s",l.utils.formatJSON(r.toJSON()))}.bind(this)),Promise.resolve().then(function(){return r.init?r.init(e):r}).then(function(){return c.info("add area: %s",l.utils.formatJSON(r.toJSON())),r})}},{key:"findArea",value:function(e){for(var t in this.areas){var n=this.areas[t];if(n.id===e)return n}return null}},{key:"findPlayer",value:function(e){var t=this.areas;for(var n in t){var r=t[n].findPlayer(e);if(r)return r}return null}}]),t}();if(void 0!==r&&r){r.jm||(r.jm={});var v=r.jm;v.game||(v.Game=d,v.game=function(e){return new d(e)})}n.default=d,t.exports=n.default}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./area":1,"./player":3,"jm-ecs":10,"jm-logger":20,"jm-utils":21}],3:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("jm-ecs"),a=(r=i)&&r.__esModule?r:{default:r};var s=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return n.id&&(e.id=n.id),e.toJSON=function(){var e={type:this.type,entityId:this.entityId,id:this.id};return this.emit("toJSON",e),e},r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default.C),o(t,[{key:"className",get:function(){return t.className||t.name}}]),t}();s.className="player",s.singleton=!0,n.default=s,t.exports=n.default},{"jm-ecs":10}],4:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("./obj"),a=(r=i)&&r.__esModule?r:{default:r};var s=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return r._entity=e,r.active=!0,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),o(t,[{key:"toJSON",value:function(){return{className:this.className}}},{key:"entity",get:function(){return this._entity}},{key:"className",get:function(){return t.className||t.name}},{key:"singleton",get:function(){return t.singleton}},{key:"name",get:function(){return this._name||this.className},set:function(e){t.nameReadOnly||(this._name=e)}}]),t}();s.className="component",s.singleton=!1,s.nameReadOnly=!1,n.default=s,t.exports=n.default},{"./obj":11}],5:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=800;n.default={Err:{InvalidComponent:{err:r++,msg:"invalid component ${name}"},SingletonComponent:{err:r++,msg:"singleton component ${name} already exists"}}},t.exports=n.default},{}],6:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=f(e("jm-err")),a=f(e("jm-logger")),s=f(e("./obj")),u=f(e("./component")),l=f(e("./em"));function f(e){return e&&e.__esModule?e:{default:e}}function c(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var y=a.default.getLogger("jm-ecs"),d=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._components={},n.use(u.default),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.default),o(t,[{key:"use",value:function(e,t){if(!e)throw i.default.err(i.default.Err.FA_PARAMS);if(t||(t=e.className||e.name),!t)throw i.default.err(i.default.Err.FA_PARAMS);var n=this._components;return n[t]&&y.warn("use Compoent already exists for "+t+", replaced."),n[t]=e,this.emit("use",t,e),this}},{key:"uses",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var o=!0,i=!1,a=void 0;try{for(var s,u=t[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var l=s.value;Array.isArray(l)?this.uses.apply(this,c(l)):"object"===(void 0===l?"undefined":r(l))?this.use(l.class,l.name):this.use(l)}}catch(e){i=!0,a=e}finally{try{!o&&u.return&&u.return()}finally{if(i)throw a}}return this}},{key:"unuse",value:function(e){var t=this._components,n=t[e];return n&&this.emit("unuse",e,n),delete t[e],this}},{key:"component",value:function(e){return this._components[e]}},{key:"em",value:function(e){var t=new l.default(this,e);return this.emit("em",t),t}},{key:"toJSON",value:function(){return{components:this.components}}},{key:"components",get:function(){return this._components}}]),t}();d.EM=l.default,d.C=u.default,d.Obj=s.default,n.default=d,t.exports=n.default},{"./component":4,"./em":7,"./obj":11,"jm-err":12,"jm-logger":16}],7:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("jm-utils"),a=l(e("./obj")),s=l(e("./entity")),u=l(e("./factory"));function l(e){return e&&e.__esModule?e:{default:e}}var f=l(e("jm-logger")).default.getLogger("jm-ecs"),c=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return r._ecs=e,r._entityTypes={},r._pools={},r._entities={},r._entitiesByName={},r._entitiesByTag={},r.f=new u.default(r),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),o(t,[{key:"e",value:function(e){return new s.default(this,e)}},{key:"addEntityType",value:function(e,t){return this._entityTypes[e]&&f.warn("add entityType already exists for "+e+", replaced."),this._entityTypes[e]=t,this}},{key:"addEntityTypes",value:function(e){for(var t in e)this.addEntityType(t,e[t]);return this}},{key:"entityType",value:function(e){return this._entityTypes[e]}},{key:"__createEntityFromPool",value:function(e,t,n){if(!this._entityTypes[e].poolable)return null;if(n)return null;if(t&&t.parent)return null;if(this._pools[e]){var r=this._pools[e].shift();if(r)return r.emit("reuse",t),this.addEntity(r),r}return null}},{key:"createEntity",value:function(e,t,n){var r=null;if(r=this.__createEntityFromPool(e,t,n))return r;var o=t;return t={},t=i.utils.cloneDeep(this._entityTypes[e]),o&&(t=i.utils.merge(t,i.utils.cloneDeep(o))),n&&(t.parent=n),(r=this.f.create(t))?(r.type=e,r.addTag(e),t.tags&&r.addTags(t.tags),this.addEntity(r),this.createEntityChildren(r,t),r):null}},{key:"createEntityChildren",value:function(e,t){for(var n in t.children){var r=t.children[n];if(r){var o=null;if("jm.Entity"===(r.className||"jm.Entity")){var i=r.type;o=this.createEntity(i,r,e)}e.children||(e.children=[]),e.children.push(o)}}}},{key:"addEntity",value:function(e,t){return e&&e.entityId?(t&&e.addTag(t),this._entities[e.entityId]=e,e.name&&(this._entitiesByName[e.name]=e),e.emit("add",this),this.emit("addEntity",e),this):this}},{key:"__removeEntityToPool",value:function(e){var t=e.type;if(!this._entityTypes[t].poolable)return!1;if(e.parent)return!1;this._pools[t]||(this._pools[t]=[]);var n=this._pools[t];return e.emit("unuse"),n.push(e),!0}},{key:"clearPool",value:function(e){var t=this._pools[e];if(t)return this._pools[e]=[],t.forEach(function(e){e.destroy()}),this}},{key:"clearPools",value:function(){for(var e in this._pools)this.clearPool(e);return this}},{key:"removeEntity",value:function(e){var t=void 0;return(t="object"===(void 0===e?"undefined":r(e))?e:this._entities[e])?(this.removeEntityChildren(t),t.emit("remove",this),this.emit("removeEntity",t),delete this._entities[t.entityId],t.name&&delete this._entitiesByName[t.name],this.__removeEntityToPool(t)?this:(t.destroy(),this)):this}},{key:"removeEntityChildren",value:function(e){var t=e.children;for(var n in t){var r=t[n];this.removeEntity(r.entityId)}return this}},{key:"removeEntities",value:function(e){for(var t in e)this.removeEntity(e[t]);return this}},{key:"removeEntitiesByType",value:function(e){var t=[];for(var n in this._entities){var r=this._entities[n];r.type===e&&t.push(r)}return this.removeEntities(t),this}},{key:"getEntities",value:function(e){var t=this._entities;if(!e)return t;var n={};if("string"==typeof e){var r=!1,o=!1,i=void 0;if(-1!==e.indexOf(",")?(o=!0,i=/\s*,\s*/):-1!==e.indexOf(" ")&&(r=!0,i=/\s+/),!r&&!o)return this._entitiesByTag[e];var a=e.split(i),s=void 0;for(var u in t){if(s=t[u],r){if(!s.hasTagAll(a))continue}else if(o&&!s.hasTagAny(a))continue;n[u]=s}}return n}},{key:"getEntity",value:function(e){var t=this.getEntities(e);for(var n in t)return t[n];return null}},{key:"update",value:function(e){this.emit("update",e)}},{key:"toJSON",value:function(){return{ecs:this.ecs,entities:this.entities}}},{key:"ecs",get:function(){return this._ecs}},{key:"entityTypes",get:function(){return this._entityTypes}},{key:"pools",get:function(){return this._pools}},{key:"entities",get:function(){return this._entities}},{key:"entitiesByName",get:function(){return this._entitiesByName}},{key:"entitiesByTag",get:function(){return this._entitiesByTag}}]),t}();n.default=c,t.exports=n.default},{"./entity":8,"./factory":9,"./obj":11,"jm-logger":16,"jm-utils":19}],8:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("jm-utils"),a=l(e("jm-tag")),s=l(e("jm-err")),u=l(e("./obj"));function l(e){return e&&e.__esModule?e:{default:e}}var f=l(e("./consts")).default.Err,c=1;function y(e){for(var t in e)return!1;return!0}function d(e,t){if(e){var n=e.indexOf(t);-1!==n&&e.splice(n,1)}}var v=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return a.default.enableTag(r),r._em=e,r._ecs=e.ecs,r._components={},r._componentsByClass={},r._componentGUID=1,r.active=!0,r.entityId=c++,r.on("addTag",function(t){e._entitiesByTag[t]||(e._entitiesByTag[t]={}),e._entitiesByTag[t][r.entityId]=r}),r.on("removeTag",function(t){var n=e._entitiesByTag[t];n&&(delete n[r.entityId],y(n)&&delete e._entitiesByTag[t])}),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u.default),o(t,[{key:"destroy",value:function(){(function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0})(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this),this.removeAllComponents(),this.removeAllTags()}},{key:"use",value:function(e,t,n){var r=this.ecs;if("string"==typeof e&&(n||(n=e),!(e=r.component(e))))throw s.default.err(f.InvalidComponent,{name:e});if(!e)throw s.default.err(s.default.Err.FA_PARAMS);var o=new e(this,t),i=this._components,a=this._componentsByClass;n||(n=o.className);var u=o.className;if(n in i){if(e.singleton)throw s.default.err(f.SingletonComponent,{name:n});n=u+this._componentGUID++}a[u]||(a[u]={});var l=a[u];return i[n]=o,l[n]=o,this[n]=o,this.addTag(u),e.alias&&this.addTag(e.alias),o.emit("use",this),this.emit("use",o),this}},{key:"unuse",value:function(e){var t=this._components,n=this._componentsByClass,r=e,o=void 0;if("string"==typeof r&&(o=r,r=t[r]),!r)return this;o||(o=r.name);var i=r.className,a=n[i];return delete t[o],delete a[o],delete this[o],a.length||this.removeTag(i),r.emit("unuse",this),this.emit("unuse",r),r.destroy(),this}},{key:"removeChild",value:function(e){this.em.removeEntity(e.entityId),this.children=d(this.children,e),e.destroy()}},{key:"removeFromParent",value:function(){this.parent?this.parent.removeChild(this):this.em.removeEntity(this.entityId)}},{key:"removeComponents",value:function(e){var t=this.getComponents(e);for(var n in t)this.unuse(n);return delete this._componentsByClass[e],this.emit("removeComponents",e),this}},{key:"removeAllComponents",value:function(){var e=this._components;for(var t in e)this.unuse(t);return this.emit("removeAllComponents"),this}},{key:"getComponent",value:function(e){return this._components[e]}},{key:"getComponents",value:function(e){return this._componentsByClass[e]}},{key:"_clip",value:function(e,t){if(e)for(var n in t){var o=t[n],i=e[n];"object"!==(void 0===o?"undefined":r(o))?o===i&&delete t[n]:(i&&this._clip(i,o),y(o)&&delete t[n])}}},{key:"toJSON",value:function(){var e=this.type,t={type:e,tags:[],components:{}};t.tags=i.utils.cloneDeep(this.tags),t.tags=d(t.tags,e);var n=t.components,r=this.components;for(var o in r){var a=r[o];n[o]=a.toJSON(),t.tags=d(t.tags,o),t.tags=d(t.tags,a.className),o===n[o].className&&delete n[o].className}var s=this.em.entityType(e);if(s){for(var u in s.tags)t.tags=d(t.tags,s.tags[u]);this._clip(s,t)}t.tags&&!t.tags.length&&delete t.tags,r=this.children;for(var l in r){var f=r[l];t.children||(t.children=[]),t.children.push(f.toJSON())}return t}},{key:"em",get:function(){return this._em}},{key:"ecs",get:function(){return this._ecs}},{key:"components",get:function(){return this._components}},{key:"componentsByClass",get:function(){return this._componentsByClass}}]),t}();n.default=v,t.exports=n.default},{"./consts":5,"./obj":11,"jm-err":12,"jm-tag":17,"jm-utils":19}],9:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("./obj"),a=(r=i)&&r.__esModule?r:{default:r};var s=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return r.em=e,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),o(t,[{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.em.e();if(!e.components)return t;e.parent&&(t.parent=e.parent);var n=!0,r=!1,o=void 0;try{for(var i,a=Object.keys(e.components)[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value,u=e.components[s],l=u.className||s;u.className&&delete u.className,t.use(l,u,s)}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}return this.emit("create",t),t}}]),t}();n.default=s,t.exports=n.default},{"./obj":11}],10:[function(e,t,n){(function(r){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o,i=e("./ecs"),a=(o=i)&&o.__esModule?o:{default:o};void 0!==r&&r&&r.jm&&(r.jm.ECS=a.default,r.jm.ecs=function(e){return new a.default(e)}),n.default=a.default,t.exports=n.default}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./ecs":6}],11:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("jm-event"),a=(r=i)&&r.__esModule?r:{default:r};var s=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));if(e){var r=!0,o=!1,i=void 0;try{for(var a,s=Object.keys(e)[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;n[u]=e[u]}}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}}return n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default.EventEmitter),o(t,[{key:"destroy",value:function(){this.emit("destroy",this)}}]),t}();n.default=s,t.exports=n.default},{"jm-event":15}],12:[function(e,t,n){(function(r){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o,i=e("./locale"),a=(o=i)&&o.__esModule?o:{default:o};var s={SUCCESS:{err:0,msg:"Success"},FAIL:{err:1,msg:"Fail"},FA_SYS:{err:2,msg:"System Error"},FA_NETWORK:{err:3,msg:"Network Error"},FA_PARAMS:{err:4,msg:"Parameter Error"},FA_BUSY:{err:5,msg:"Busy"},FA_TIMEOUT:{err:6,msg:"Time Out"},FA_ABORT:{err:7,msg:"Abort"},FA_NOTREADY:{err:8,msg:"Not Ready"},FA_NOTEXISTS:{err:9,msg:"Not Exists"},FA_EXISTS:{err:8,msg:"Already Exists"},OK:{err:200,msg:"OK"},FA_BADREQUEST:{err:400,msg:"Bad Request"},FA_NOAUTH:{err:401,msg:"Unauthorized"},FA_NOPERMISSION:{err:403,msg:"Forbidden"},FA_NOTFOUND:{err:404,msg:"Not Found"},FA_INTERNALERROR:{err:500,msg:"Internal Server Error"},FA_UNAVAILABLE:{err:503,msg:"Service Unavailable"}};s.t=a.default;var u=function(e,t){if(t)for(var n in t)e=e.split("${"+n+"}").join(t[n]);return e},l=function(e,t){"string"==typeof e&&(e={msg:e});var n=u(e.msg,t),r=new Error(n);return e.err&&(r.code=e.err),r},f=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Err";return!e[t]&&(e[t]=s,e.err=l,e.errMsg=u,!0)},c={Err:s,errMsg:u,err:l,enableErr:f,disableErr:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Err";e[t]&&(delete e[t],delete e.err,delete e.errMsg)}};if(void 0!==r&&r){r.jm||(r.jm={});var y=r.jm;if(!y.enableErr){f(y);for(var d in c)y[d]=c[d]}}n.default=c,t.exports=n.default}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./locale":13}],13:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e,t){return t&&i[t]?i[t][e]:null};var r,o=e("./zh_CN");var i={zh_CN:((r=o)&&r.__esModule?r:{default:r}).default};t.exports=n.default},{"./zh_CN":14}],14:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default={Success:"成功",Fail:"失败","System Error":"系统错误","Network Error":"网络错误","Parameter Error":"参数错误",Busy:"忙","Time Out":"超时",Abort:"中止","Not Ready":"未准备好","Not Exists":"不存在","Already Exists":"已存在",OK:"OK","Bad Request":"错误请求",Unauthorized:"未验证",Forbidden:"无权限","Not Found":"未找到","Internal Server Error":"服务器内部错误","Service Unavailable":"无效服务"},t.exports=n.default},{}],15:[function(e,t,n){(function(e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._events={}}return r(e,[{key:"on",value:function(e,t,n){return this._events[e]||(this._events[e]=[]),n?this._events[e].unshift(t):this._events[e].push(t),this}},{key:"once",value:function(e,t,n){var r=this;return this.on(e,function n(o,i,a,s,u){r.off(e,n),t(o,i,a,s,u)},n)}},{key:"off",value:function(e,t){if(t){if(this._events&&this._events[e])for(var n=this._events[e],r=0;r<n.length;r++)if(t===n[r]){n.splice(r,1),n.length||delete this._events[e];break}}else void 0===e?this._events={}:this._events&&this._events[e]&&delete this._events[e];return this}},{key:"emit",value:function(e,t,n,r,o,i){for(var a=this.listeners(e),s=0;s<a.length;s++){if(!1===(0,a[s])(t,n,r,o,i))break}return this}},{key:"eventNames",value:function(){return Object.keys(this._events)}},{key:"listeners",value:function(e){var t=this._events[e];if(!t)return[];for(var n=new Array(t.length),r=0;r<t.length;r++)n[r]=t[r];return n}}]),e}(),i=o.prototype,a={_events:{},on:i.on,once:i.once,off:i.off,emit:i.emit,eventNames:i.eventNames,listeners:i.listeners},s=function(e){if(void 0!==e.emit)return!1;for(var t in a)e[t]=a[t];return e._events={},!0},u=function(e){if(void 0!==e.emit)for(var t in a)delete e[t]},l={EventEmitter:o,enableEvent:s,disableEvent:u,moduleEvent:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"event",t=this;return t.enableEvent=s,t.disableEvent=u,{name:e,unuse:function(){delete t.enableEvent,delete t.disableEvent}}}};if(void 0!==e&&e){e.jm||(e.jm={});var f=e.jm;if(!f.EventEmitter)for(var c in l)f[c]=l[c]}n.default=l,t.exports=n.default}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],16:[function(e,t,n){(function(e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(e){return console.debug||(console.debug=console.log),console},o={logger:r(),getLogger:r,moduleLogger:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"logger",t=this;return t.getLogger=r,t.logger=r(),{name:e,unuse:function(){delete t.logger,delete t.getLogger}}}};if(void 0!==e&&e){e.jm||(e.jm={});var i=e.jm;if(!i.logger)for(var a in o)i[a]=o[a]}n.default=o,t.exports=n.default}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],17:[function(e,t,n){(function(r){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=e("jm-event"),s=(o=a)&&o.__esModule?o:{default:o};var u=s.default.EventEmitter,l=s.default.enableEvent,f=s.default.disableEvent,c=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e._tags=[],Object.defineProperty(e,"tags",{value:e._tags,writable:!1}),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u),i(t,[{key:"destroy",value:function(){this.emit("destroy",this),this.removeAllTags()}},{key:"hasTag",value:function(e){return-1!=this._tags.indexOf(e)}},{key:"hasTagAny",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=e[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;if(this.hasTag(a))return!0}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}return!1}},{key:"hasTagAll",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=e[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;if(!this.hasTag(a))return!1}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}return!0}},{key:"addTag",value:function(e){var t=this._tags;return this.hasTag(e)?this:(t.push(e),this.emit("addTag",e),this)}},{key:"addTags",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=e[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;this.addTag(a)}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}return this}},{key:"removeTag",value:function(e){var t=this._tags,n=t.indexOf(e);return n>=0&&t.splice(n,1),this.emit("removeTag",e),this}},{key:"removeTags",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=e[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;this.removeTag(a)}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}return this}},{key:"removeAllTags",value:function(){var e=this._tags,t=!0,n=!1,r=void 0;try{for(var o,i=e[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;this.emit("removeTag",a)}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}return this._tags=[],this.emit("removeAllTags"),this}}]),t}(),y=c.prototype,d={_tags:[],hasTag:y.hasTag,hasTagAny:y.hasTagAny,hasTagAll:y.hasTagAll,addTag:y.addTag,addTags:y.addTags,removeTag:y.removeTag,removeTags:y.removeTags,removeAllTags:y.removeAllTags},v=function(e){if(void 0!=e._tags)return!1;var t=!0,n=!1,r=void 0;try{for(var o,i=Object.keys(d)[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;e[a]=d[a]}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}return e._tags=[],Object.defineProperty(e,"tags",{value:e._tags,writable:!1}),l(e),!0},h=function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=Object.keys(d)[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){delete e[o.value]}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}f(e)},p={TagObject:c,enableTag:v,disableTag:h,moduleTag:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"tag";return e.enableTag=v,e.disableTag=h,{name:t,unuse:function(){delete e.enableTag,delete e.disableTag}}}};if(void 0!==r&&r){r.jm||(r.jm={});var m=r.jm;if(!m.TagObject)for(var b in p)m[b]=p[b]}n.default=p,t.exports=n.default}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"jm-event":18}],18:[function(e,t,n){(function(e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._events={}}return r(e,[{key:"on",value:function(e,t,n){return this._events[e]||(this._events[e]=[]),n?this._events[e].unshift(t):this._events[e].push(t),this}},{key:"once",value:function(e,t,n){var r=this;return this.on(e,function n(o,i,a,s,u){r.off(e,n),t(o,i,a,s,u)},n)}},{key:"off",value:function(e,t){if(t){if(this._events&&this._events[e])for(var n=this._events[e],r=0;r<n.length;r++)if(t===n[r]){n.splice(r,1),n.length||delete this._events[e];break}}else void 0===e?this._events={}:this._events&&this._events[e]&&delete this._events[e];return this}},{key:"emit",value:function(e,t,n,r,o,i){for(var a=this.listeners(e),s=0;s<a.length;s++){if(!1===(0,a[s])(t,n,r,o,i))break}return this}},{key:"eventNames",value:function(){return Object.keys(this._events)}},{key:"listeners",value:function(e){var t=this._events[e];if(!t)return[];for(var n=new Array(t.length),r=0;r<t.length;r++)n[r]=t[r];return n}}]),e}(),i=o.prototype,a={_events:{},on:i.on,once:i.once,off:i.off,emit:i.emit,eventNames:i.eventNames,listeners:i.listeners},s=function(e){if(void 0!==e.emit)return!1;var t=!0,n=!1,r=void 0;try{for(var o,i=Object.keys(a)[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var s=o.value;e[s]=a[s]}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}return e._events={},!0},u=function(e){if(void 0!==e.emit){var t=!0,n=!1,r=void 0;try{for(var o,i=Object.keys(a)[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){delete e[o.value]}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}}},l={EventEmitter:o,enableEvent:s,disableEvent:u,moduleEvent:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"event";return e.enableEvent=s,e.disableEvent=u,{name:t,unuse:function(){delete e.enableEvent,delete e.disableEvent}}}};if(void 0!==e&&e){e.jm||(e.jm={});var f=e.jm;if(!f.EventEmitter)for(var c in l)f[c]=l[c]}n.default=l,t.exports=n.default}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],19:[function(e,t,n){(function(e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o="[object Boolean]",i="[object Date]",a="[object Number]",s="[object RegExp]",u="[object String]",l={};l["[object Function]"]=!1,l["[object Arguments]"]=!0,l["[object Array]"]=!0,l[o]=!0,l[i]=!0,l[a]=!0,l["[object Object]"]=!0,l[s]=!0,l[u]=!0;var f={};f["[object Array]"]=Array,f[o]=Boolean,f[i]=Date,f["[object Object]"]=Object,f[a]=Number,f[s]=RegExp,f[u]=String;var c=/\w*$/,y={slice:function(e,t,n){t=t||0,n=n||e.length,t<0&&(t+=e.length),n<0&&(n+=e.length);for(var r=new Array(n-t),o=t;o<n;o++)r[o-t]=e[o];return r},formatJSON:function(e){return JSON.stringify(e,null,2)},getUriProtocol:function(e){return e?e.substring(0,e.indexOf(":")):null},getUriPath:function(e){var t=e.indexOf("//");return-1===t?"":-1===(t=e.indexOf("/",t+2))?"":(-1===(t=(e=e.substr(t)).indexOf("#"))&&(t=e.indexOf("?")),-1!==t&&(e=e.substr(0,t)),e)},cloneDeep:function e(t){if("object"!==(void 0===t?"undefined":r(t))||!t)return t;if(Array.isArray(t)){var n=[];return t.forEach(function(t){n.push(e(t))}),n}var y=toString.call(t);if(!l[y])return t;var d=f[y];switch(y){case o:case i:return new d(+t);case a:case u:return new d(t);case s:return d(t.source,c.exec(t))}var v={};return Object.keys(t).forEach(function(n){v[n]=e(t[n])}),v},merge:function e(t,n){return"object"===(void 0===t?"undefined":r(t))&&t?Array.isArray(t)?(n.forEach(function(e){-1===t.indexOf(e)&&t.push(e)}),t):(Object.keys(n).forEach(function(o){t[o]&&"object"===r(t[o])&&"object"===r(n[o])?e(t[o],n[o]):t[o]=n[o]}),t):t}},d={utils:y,moduleUtils:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"utils",t=this;return t[e]=y,{name:e,unuse:function(){delete t[e]}}}};if(void 0!==e&&e){e.jm||(e.jm={});var v=e.jm;if(!v.utils)for(var h in d)v[h]=d[h]}n.default=d,t.exports=n.default}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],20:[function(e,t,n){t.exports=e(16)},{}],21:[function(e,t,n){(function(e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r={slice:function(e,t,n){t=t||0,n=n||e.length,t<0&&(t+=e.length),n<0&&(n+=e.length);for(var r=new Array(n-t),o=t;o<n;o++)r[o-t]=e[o];return r},formatJSON:function(e){return JSON.stringify(e,null,2)},getUriProtocol:function(e){return e?e.substring(0,e.indexOf(":")):null},getUriPath:function(e){var t=e.indexOf("//");return-1==t?"":-1==(t=e.indexOf("/",t+2))?"":(-1==(t=(e=e.substr(t)).indexOf("#"))&&(t=e.indexOf("?")),-1!=t&&(e=e.substr(0,t)),e)}},o={utils:r,moduleUtils:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"utils",t=this;return t[e]=r,{name:e,unuse:function(){delete t[e]}}}};if(void 0!==e&&e){e.jm||(e.jm={});var i=e.jm;if(!i.utils)for(var a in o)i[a]=o[a]}n.default=o,t.exports=n.default}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[2]);